                                <h3>The Basics</h3>
                                <p class="centered"><i class="icon icon-circle"></i><i class="icon icon-circle"></i><i class="icon icon-circle"></i></p>
<div class="col-lg-10 col-lg-offset-1 text-justify">
<p>The major use of systemd that you will need to get your head around first, is that it manages services. Just as <code>Upstart</code> or <code>/etc/init.d/</code> scripts can start, stop, and tell you the
status of your system's services (httpd, sshd, mysqld, etc), systemd's <code>systemctl</code> provides roughly equivalent functionality.</p>
<h3>Start and Stop Services</h3>
<p>To start or stop a service such as SSH, you use the <code>systemctl start sshd</code> or <code>systemctl stop sshd</code> commands. True to the Unix tradition, it doesn't output anything at all, it just does what you tell it, whether that is starting or stopping the service.</p>
<h3>Check the Status of a Service</h3>
<p>To check the status of a service, you guessed it - it's <code>systemctl status sshd</code>. This is where it gets complicated, quickly. There's no middle-ground with systemd. <code>systemctl status</code> gives you far more information than you generally need, and presented in an often very misleading manner.</p>
<pre>
# systemctl status sshd
‚óè sshd.service - OpenSSH server daemon
   Loaded: loaded (/usr/lib/systemd/system/sshd.service; enabled; vendor preset: disabled)
   Active: inactive (dead) since Thu 2017-09-28 22:34:44 BST; 2min 14s ago
     Docs: man:sshd(8)
           man:sshd_config(5)
 Main PID: 691 (code=exited, status=0/SUCCESS)

Sep 19 23:08:32 fedora26.steve-parker.org systemd[1]: Starting OpenSSH server daemon...
Sep 19 23:08:33 fedora26.steve-parker.org sshd[691]: Server listening on 0.0.0.0 port 22.
Sep 19 23:08:33 fedora26.steve-parker.org sshd[691]: Server listening on :: port 22.
Sep 19 23:08:33 fedora26.steve-parker.org systemd[1]: Started OpenSSH server daemon.
Sep 19 23:08:46 fedora26.steve-parker.org sshd[1175]: Accepted password for steve from 192.168.8.73 port 37381 ssh2
Sep 21 22:52:38 fedora26.steve-parker.org sshd[26086]: Accepted password for steve from 192.168.8.73 port 47870 ssh2
Sep 28 22:34:44 fedora26.steve-parker.org sshd[691]: Received signal 15; terminating.
Sep 28 22:34:44 fedora26.steve-parker.org systemd[1]: Stopping OpenSSH server daemon...
Sep 28 22:34:44 fedora26.steve-parker.org systemd[1]: Stopped OpenSSH server daemon.
# 
</pre>
<p>This sshd is stopped. PID 691 is not running, but it was the main PID the last time sshd was active.</p>
<p>The <code>Loaded:</code> line tells you that the service is enabled - that is, it will start on boot, although the default for this distribution (Fedora) is that SSH is disabled. So it has been manually activated by the administrator.</p>
<p>The <code>Active: inactive (dead)</code> line does not mean that it is active. It is dead, and has been for 2 minutes and 14 seconds. If it was active, it would say <code>Active: active</code>. Obviously.</p>
<p>The <code>Main PID:</code> line tells you that it has exited ("code=exited"), and it stopped the service successfully (status=0/SUCCESS). This is basically saying that it successfully stopped the service; it hadn't crashed, failed to stop, or otherwise ended up dead. It is inactive (oh sorry, this is systemd - it's listed as "Active" of course. But it's dead, alright?) it's dead because systemd was told to stop the service, and systemd successfully arranged that for you. Didn't it do well? Go and get yourself an ice-cream, systemd. Well done.</p>
<p>If it had failed to stop the sshd service, it would have looked something like this <code>iscsid</code> process which had failed to stop:</p>
<pre>
  Process: 12375 ExecStop=/sbin/iscsiadm -k 0 2 <font color=red>(code=exited, status=203/EXEC)</font>
</pre>
<p>Some of the text here is red. systemd enjoys colouring in. It likes to show bad things in red, and good things in green. It isn't always quite sure what a "good" or "bad" message actually looks like, though, so don't assume that all red messages are bad, or that all green messages are good. Similarly, terribly fatal messages may not be highlighted at all. systemd is trying, though, and if it keeps the effort up, it might be allowed to use more colours next term.</p>
<p>The rest of the output is just some stuff that systemd noticed sshd saying during its run. Some of it is startup messages, some of it is messages as it's operating (a user called 'steve' logged in). Then it was killed (by systemd). These messages aren't even necessarily in order, particularly the ones from systemd itself. Note that sshd reported receiving the signal 15 ("kill") signal moments before systemd reported that it was about to stop it:</p>
<pre>
Sep 28 22:34:44 fedora26.steve-parker.org sshd[691]: Received signal 15; terminating.
Sep 28 22:34:44 fedora26.steve-parker.org systemd[1]: Stopping OpenSSH server daemon...
Sep 28 22:34:44 fedora26.steve-parker.org systemd[1]: Stopped OpenSSH server daemon.
</pre>
<p>So it's hard to take these lines too seriously. It's actually incredibly easy to trick yourself (or, if you're bored, trick somebody else, like a line manager, for example) that it's saying something very different about the current state of the service, than it actually is.</p>
<h3>Summary</h3>
<p>The return code for <code>systemctl status</code> should be zero if all's well, and non-zero otherwise. Often 3. Always 3? Really, I'm not sure. I will find out, and when I do, I'll be sure to make a note of it here.</p>

                                </div>
