<!DOCTYPE html>
<html lang="en">
  <head>
<!-- Global Site Tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-107197722-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments)};
  gtag('js', new Date());

  gtag('config', 'UA-107197722-1');
</script>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="shortcut icon" href="../assets/ico/favicon.png">

    <title>I Hate Systemd</title>

    <!-- Bootstrap core CSS -->
    <link href="../assets/css/bootstrap.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="../assets/css/main.css" rel="stylesheet">
	<link rel="stylesheet" href="../assets/css/font-awesome.min.css">

    <script src="../assets/js/jquery.min.js"></script>
	<!-- <script src="../assets/js/modernizr.custom.js"></script> -->
	

	
    <link href='../assets/css/oswald.css' rel='stylesheet' type='text/css'>
    <link href='../assets/css/garamond.css' rel='stylesheet' type='text/css'>

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="../assets/js/html5shiv.js"></script>
      <script src="../assets/js/respond.min.js"></script>
    <![endif]-->
  </head>

  <body data-spy="scroll" data-offset="0" data-target="#theMenu">
		
	<!-- Menu -->
	<nav class="menu" id="theMenu">
		<div class="menu-wrap">
			<h1 class="logo"><a href="/#home">i hate systemd</a></h1>
			<i class="icon-remove menu-close"></i>
			<a href="/#home" class="smoothScroll">Home</a>
			<a href="#basics" class="smoothScroll">The Basics</a>
			<a href="#unitfiles" class="smoothScroll">Unit Files</a>
			<a href="#systemctl" class="smoothScroll">Systemctl Commands</a>
			<a href="#logs" class="smoothScroll">Logs</a>
			<a href="#"><i class="icon-facebook"></i></a>
			<a href="https://twitter.com/ihatesystemd"><i class="icon-twitter"></i></a>
			<a href="#"><i class="icon-dribbble"></i></a>
			<a href="#"><i class="icon-envelope"></i></a>
		</div>
		
		<!-- Menu button -->
		<div id="menuToggle"><i class="icon-reorder"></i></div>
	</nav>


	
	<!-- ========== HEADER SECTION ========== -->
	<section id="home" name="home"></section>
	<div id="headerwrap">
		<div class="container">
			<div class="logo">
				<img src="../assets/img/logo.png">
			</div>
			<br>
			<div class="row">
				<h1>i hate systemd</h1>
				<br>
                                <h3>The Good, The Bad, The Ugly.</h3>
				<br>
                                <p class="centered"><i class="icon icon-circle"></i> <i class="icon icon-circle"></i> <i class="icon icon-circle"></i></p>

                                <h3>And The Survival Guide.</h3>
<p><i>(Work In Progress)</i></p>
				<div class="col-lg-6 col-lg-offset-3">
				</div>
			</div>
		</div><!-- /container -->
	</div><!-- /headerwrap -->


        <section id="content" name="content"></section>
        <div id="f">
                <div class="container">
                        <div class="row">
				<h3>The Systemd Survival Guide</h3>
				<p class="centered"><i class="icon icon-circle"></i><i class="icon icon-circle"></i><i class="icon icon-circle"></i></p>
				
                        	<div class="col-lg-10 col-lg-offset-1 text-justify">
					<p>So there's some Good, some Bad, some Ugly.</p>
					<p>But to get paid, you're likely going to have to work with it, so here's a guide to help you to survive it.</p>
				</div>
  <div class="col-lg-10 col-lg-offset-1">
      <p>At least until your cunning:
      <br><b>{ Ponzi Scheme | <br>Money Laundering | 
      <br>Creating The Next Facebook / Twitter / Uber |
      <br>Marrying a Gorgeous yet Gullible Millionaire | <br>Insert Other Get-Rich-Quick Scheme Here <br>} plan</b>
      <br>works out for you, and you can retire to a life of luxury.</p>
  </div>
  <div class="col-lg-10 col-lg-offset-1 text-justify">
    <p>In the meantime, hopefully this guide will be helpful. And please do remember to think of us from time to time when you're cruising in your luxury yacht, sipping a cocktail - with the beautiful yet gullible millionaire by your side, of course.</p>
  </div>

			</div> <!-- /row -->
		</div> <!-- /container -->
	</div> <!-- /f -->

        <section id="basics" name="basics"></section>
        <div id="f"><div class="container"><div class="row">
			                                <h3>The Basics</h3>
                                <p class="centered"><i class="icon icon-circle"></i><i class="icon icon-circle"></i><i class="icon icon-circle"></i></p>
<div class="col-lg-10 col-lg-offset-1 text-justify">
<p>The major use of systemd that you will need to get your head around first, is that it manages services. Just as <code>Upstart</code> or <code>/etc/init.d/</code> scripts can start, stop, and tell you the
status of your system's services (httpd, sshd, mysqld, etc), systemd's <code>systemctl</code> provides roughly equivalent functionality.</p>
<h3>Start and Stop Services</h3>
<p>To start or stop a service such as SSH, you use the <code>systemctl start sshd</code> or <code>systemctl stop sshd</code> commands. True to the Unix tradition, it doesn't output anything at all, it just does what you tell it, whether that is starting or stopping the service.</p>
<h3>Check the Status of a Service</h3>
<p>To check the status of a service, you guessed it - it's <code>systemctl status sshd</code>. This is where it gets complicated, quickly. There's no middle-ground with systemd. <code>systemctl status</code> gives you far more information than you generally need, and presented in an often very misleading manner.</p>
<pre>
# systemctl status sshd
● sshd.service - OpenSSH server daemon
   Loaded: loaded (/usr/lib/systemd/system/sshd.service; enabled; vendor preset: disabled)
   Active: inactive (dead) since Thu 2017-09-28 22:34:44 BST; 2min 14s ago
     Docs: man:sshd(8)
           man:sshd_config(5)
 Main PID: 691 (code=exited, status=0/SUCCESS)

Sep 19 23:08:32 fedora26.steve-parker.org systemd[1]: Starting OpenSSH server daemon...
Sep 19 23:08:33 fedora26.steve-parker.org sshd[691]: Server listening on 0.0.0.0 port 22.
Sep 19 23:08:33 fedora26.steve-parker.org sshd[691]: Server listening on :: port 22.
Sep 19 23:08:33 fedora26.steve-parker.org systemd[1]: Started OpenSSH server daemon.
Sep 19 23:08:46 fedora26.steve-parker.org sshd[1175]: Accepted password for steve from 192.168.8.73 port 37381 ssh2
Sep 21 22:52:38 fedora26.steve-parker.org sshd[26086]: Accepted password for steve from 192.168.8.73 port 47870 ssh2
Sep 28 22:34:44 fedora26.steve-parker.org sshd[691]: Received signal 15; terminating.
Sep 28 22:34:44 fedora26.steve-parker.org systemd[1]: Stopping OpenSSH server daemon...
Sep 28 22:34:44 fedora26.steve-parker.org systemd[1]: Stopped OpenSSH server daemon.
# 
</pre>
<p>This sshd is stopped. PID 691 is not running, but it was the main PID the last time sshd was active.</p>
<p>The <code>Loaded:</code> line tells you that the service is enabled - that is, it will start on boot, although the default for this distribution (Fedora) is that SSH is disabled. So it has been manually activated by the administrator.</p>
<p>The <code>Active: inactive (dead)</code> line does not mean that it is active. It is dead, and has been for 2 minutes and 14 seconds. If it was active, it would say <code>Active: active</code>. Obviously.</p>
<p>The <code>Main PID:</code> line tells you that it has exited ("code=exited"), and it stopped the service successfully (status=0/SUCCESS). This is basically saying that it successfully stopped the service; it hadn't crashed, failed to stop, or otherwise ended up dead. It is inactive (oh sorry, this is systemd - it's listed as "Active" of course. But it's dead, alright?) it's dead because systemd was told to stop the service, and systemd successfully arranged that for you. Didn't it do well? Go and get yourself an ice-cream, systemd. Well done.</p>
<p>If it had failed to stop the sshd service, it would have looked something like this <code>iscsid</code> process which had failed to stop:</p>
<pre>
  Process: 12375 ExecStop=/sbin/iscsiadm -k 0 2 <font color=red>(code=exited, status=203/EXEC)</font>
</pre>
<p>Some of the text here is red. systemd enjoys colouring in. It likes to show bad things in red, and good things in green. It isn't always quite sure what a "good" or "bad" message actually looks like, though, so don't assume that all red messages are bad, or that all green messages are good. Similarly, terribly fatal messages may not be highlighted at all. systemd is trying, though, and if it keeps the effort up, it might be allowed to use more colours next term.</p>
<p>The rest of the output is just some stuff that systemd noticed sshd saying during its run. Some of it is startup messages, some of it is messages as it's operating (a user called 'steve' logged in). Then it was killed (by systemd). These messages aren't even necessarily in order, particularly the ones from systemd itself. Note that sshd reported receiving the signal 15 ("kill") signal moments before systemd reported that it was about to stop it:</p>
<pre>
Sep 28 22:34:44 fedora26.steve-parker.org sshd[691]: Received signal 15; terminating.
Sep 28 22:34:44 fedora26.steve-parker.org systemd[1]: Stopping OpenSSH server daemon...
Sep 28 22:34:44 fedora26.steve-parker.org systemd[1]: Stopped OpenSSH server daemon.
</pre>
<p>So it's hard to take these lines too seriously. It's actually incredibly easy to trick yourself (or, if you're bored, trick somebody else, like a line manager, for example) that it's saying something very different about the current state of the service, than it actually is.</p>
<h3>Summary</h3>
<p>The return code for <code>systemctl status</code> should be zero if all's well, and non-zero otherwise. Often 3. Always 3? Really, I'm not sure. I will find out, and when I do, I'll be sure to make a note of it here.</p>

                                </div>
        </div></div><!-- /container --></div><!-- /f -->

        <section id="unitfiles" name="unitfiles"></section>
        <div id="f"><div class="container"><div class="row">
			                                <h3>Unit Files</h3>
                                <p class="centered"><i class="icon icon-circle"></i><i class="icon icon-circle"></i><i class="icon icon-circle"></i></p>
<div class="col-lg-10 col-lg-offset-1 text-left">
<p>Unit files are ... <code>TODO</code></p>
                                </div>
        </div></div><!-- /container --></div><!-- /f -->


        <section id="systemctl" name="systemctl"></section>
        <div id="f"><div class="container"><div class="row">
			                                <h3>Systemctl Commands</h3>
                                <p class="centered"><i class="icon icon-circle"></i><i class="icon icon-circle"></i><i class="icon icon-circle"></i></p>
<div class="col-lg-10 col-lg-offset-1 text-left">
                                        <p>Systemctl commands ...  <code>TODO</code></p>
                                </div>
        </div></div><!-- /container --></div><!-- /f -->

        <section id="logs" name="logs"></section>
        <div id="f"><div class="container"><div class="row">
			                                <h3>Logs</h3>
                                <p class="centered"><i class="icon icon-circle"></i><i class="icon icon-circle"></i><i class="icon icon-circle"></i></p>
<div class="col-lg-10 col-lg-offset-1 text-center">
<p>systemd manages logs ... actually, you'd better get yourself a drink before we start on this one.</p>
<p>I'll wait.</p>
<p>What? No, not a frothy latte, that won't do you any good where we're going.<br/>
<img src="../assets/img/illustrations/whisky.jpg" alt="© Alexandr Steblovskiy – Fotolia.com" width="206" height="145"><br/>
But okay, fine. Suit yourself. </p>
</div>
<div class="col-lg-10 col-lg-offset-1 text-justify">
<p>One of the initial criticisms of systemd was that its logs are in a binary format. Because at 3am in a cold datacentre on a vt100 green screen (if you haven't been there, just don't ask, you don't want to have been there) what you really need is a clear, plain text log of what happened to the system as it went down in flames. But the designers of systemd decided that it would be better for our moral fibre to read the logs through their tools, so - as long as systemd itself is working fine - that's great. Really, it is. It's all absolutely fine. So long as systemd is working fine. And if you're in a cold datacentre, and it's now 3.30am, and trying to dig through systemd log files to find out why you're not tucked up safely in bed, then it seems pretty bloody safe to assume that systemd isn't working fine. So maybe it's not able to read the logs. Oops</p>
<p>At least the systemd developers have a strong reputation for empathising with your situation and doing what they can to help you out.<br/>
Oh. Feck. Yeah, they don't have that reputation, do they? Quite the opposite, in fact. So. You're screwed. And now it's 4am in a cold datacentre. And you're no further along than you were before.</p>
<p>If that frothy latte hasn't gone cold, I hope it's still doing you some good.</p>
<h3>I will write sensible stuff</h3>
<p>Really, I will write some sensible stuff here about logs. Some of it is quite nice. Totally unnecessary, but yeah. Some of it isn't completely terrible.</p>
                                </div>
        </div></div><!-- /container --></div><!-- /f -->

        <div id="f">
        <p><a target="_blank" href="https://twitter.com/ihatesystemd">@ihatesystemd</a></p>
        </div>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
	<script src="../assets/js/classie.js"></script>
    <script src="../assets/js/bootstrap.min.js"></script>
    <script src="../assets/js/smoothscroll.js"></script>
	<script src="../assets/js/main.js"></script>
</body>
</html>
